<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>DragoMappers POC style</title>
<!-- MapLibre -->
<link href="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.css" rel="stylesheet" />
<script src="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.js"></script>
<!-- PMTiles JS -->
<script src="https://unpkg.com/pmtiles@3/dist/pmtiles.js"></script>
<style>
  body, html { margin: 0; height: 100%; }
  #map { width: 100%; height: 100%; }
</style>
</head>
<body>
<div id="map"></div>
<script>
// Register PMTiles protocol to MapLibre
let protocol = new pmtiles.Protocol();
maplibregl.addProtocol("pmtiles", protocol.tile);

// Parse hash or use defaults
function getMapPosition() {
  const hash = window.location.hash.slice(1); // Remove #
  if (hash) {
    const parts = hash.split('/');
    if (parts.length === 3) {
      return {
        zoom: parseFloat(parts[0]),
        center: [parseFloat(parts[2]), parseFloat(parts[1])]
      };
    }
  }
  // Default position
  return { zoom: 7, center: [-17.361, -63.336] };
}

const position = getMapPosition();

// Create viewer
const map = new maplibregl.Map({
    container: 'map',
    style: './map-styles/pavedunpavedrender.json',  
    center: position.center,
    zoom: position.zoom,
    hash: true
});

// Optional: add navigation controls
map.addControl(new maplibregl.NavigationControl());
</script>
</body>
</html>
